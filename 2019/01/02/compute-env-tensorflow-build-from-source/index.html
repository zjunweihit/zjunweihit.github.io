
 <!DOCTYPE HTML>
<html lang="default">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
  
    <title>TensorFlow Build From Source | Linux Player</title>
    <meta name="viewport" content="width=device-width, initial-scale=1,user-scalable=no">
    
    <meta name="author" content="zjunweihit">
    

    
    <meta name="description" content="How to build TensorFlow ROCm. (Verified in Ubuntu 18.04)">
<meta name="keywords" content="ROCm,TensorFlow">
<meta property="og:type" content="article">
<meta property="og:title" content="TensorFlow Build From Source">
<meta property="og:url" content="http://zjunweihit.github.io/2019/01/02/compute-env-tensorflow-build-from-source/index.html">
<meta property="og:site_name" content="Linux Player">
<meta property="og:description" content="How to build TensorFlow ROCm. (Verified in Ubuntu 18.04)">
<meta property="og:locale" content="default">
<meta property="og:updated_time" content="2019-07-09T00:55:29.867Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="TensorFlow Build From Source">
<meta name="twitter:description" content="How to build TensorFlow ROCm. (Verified in Ubuntu 18.04)">

    
    
    <link rel="icon" href="/img/L2_ico.jpg">
    
    
    <link rel="apple-touch-icon" href="/img/jacman.jpg">
    <link rel="apple-touch-icon-precomposed" href="/img/jacman.jpg">
    
    <link rel="stylesheet" href="/css/style.css">
</head>
</html>
  <body>
    <header>
      
<div>
		
			<div id="imglogo">
				<a href="/"><img src="/img/L2.jpg" alt="Linux Player" title="Linux Player"/></a>
			</div>
			
			<div id="textlogo">
				<h1 class="site-name"><a href="/" title="Linux Player">Linux Player</a></h1>
				<h2 class="blog-motto"></h2>
			</div>
			<div class="navbar"><a class="navbutton navmobile" href="#" title="Menu">
			</a></div>
			<nav class="animated">
				<ul>
					<ul>
					 
						<li><a href="/">Home</a></li>
					
						<li><a href="/archives">Archives</a></li>
					
						<li><a href="/about">About</a></li>
					
					<li>
 					
					<form class="search" action="//google.com/search" method="get" accept-charset="utf-8">
						<label>Search</label>
						<input type="search" id="search" name="q" autocomplete="off" maxlength="20" placeholder="Search" />
						<input type="hidden" name="q" value="site:zjunweihit.github.io">
					</form>
					
					</li>
				</ul>
			</nav>			
</div>
    </header>
    <div id="container">
      <div id="main" class="post" itemscope itemprop="blogPost">
  
	<article itemprop="articleBody"> 
		<header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2019/01/02/compute-env-tensorflow-build-from-source/" title="TensorFlow Build From Source" itemprop="url">TensorFlow Build From Source</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="zjunweihit" target="_blank" itemprop="author">zjunweihit</a>
		
  <p class="article-time">
    <time datetime="2019-01-02T05:27:57.000Z" itemprop="datePublished"> Published 2019-01-02</time>
    
  </p>
</header>
	<div class="article-content">
		
		<div id="toc" class="toc-article">
			<strong class="toc-title">Contents</strong>
		
			<ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Software-in-Ubuntu-18-04"><span class="toc-number">1.</span> <span class="toc-text">Software in Ubuntu 18.04</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Install-Bazel"><span class="toc-number">2.</span> <span class="toc-text">Install Bazel</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Install-bazel-online"><span class="toc-number">2.1.</span> <span class="toc-text">Install bazel online</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Install-bazel-by-binary"><span class="toc-number">2.2.</span> <span class="toc-text">Install bazel by binary</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Download-the-TensorFlow-source"><span class="toc-number">3.</span> <span class="toc-text">Download the TensorFlow source</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Build-TensorFlow-ROCm"><span class="toc-number">4.</span> <span class="toc-text">Build TensorFlow ROCm</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Verify-TensorFlow-by-hello-exmaple"><span class="toc-number">5.</span> <span class="toc-text">Verify TensorFlow by hello exmaple</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Reference"><span class="toc-number">6.</span> <span class="toc-text">Reference</span></a></li></ol>
		
		</div>
		
		<p>How to build TensorFlow ROCm. (Verified in Ubuntu 18.04)</p>
<a id="more"></a>

<h1 id="Software-in-Ubuntu-18-04"><a href="#Software-in-Ubuntu-18-04" class="headerlink" title="Software in Ubuntu 18.04"></a>Software in Ubuntu 18.04</h1><ul>
<li><p>Kernel</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">uname -r</span><br><span class="line">4.15.0-43-generic</span><br></pre></td></tr></table></figure>
</li>
<li><p>gcc</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">gcc --version</span><br><span class="line">gcc (Ubuntu 7.3.0-27ubuntu1~18.04) 7.3.0</span><br><span class="line">Copyright (C) 2017 Free Software Foundation, Inc.</span><br><span class="line">This is free software; see the source for copying conditions.  There is NO</span><br><span class="line">warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.</span><br></pre></td></tr></table></figure>
</li>
<li><p>python3</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">python3 --version</span><br><span class="line">Python 3.6.7</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h1 id="Install-Bazel"><a href="#Install-Bazel" class="headerlink" title="Install Bazel"></a>Install Bazel</h1><p>Bazel is a free software tool that allows for the automation of building and testing of software. The company Google uses the build tool Blaze internally and released and open-sourced part of the Blaze tool as Bazel, named as an anagram of Blaze.</p>
<h2 id="Install-bazel-online"><a href="#Install-bazel-online" class="headerlink" title="Install bazel online"></a>Install bazel online</h2><ul>
<li><p>Install JDK 8</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install openjdk-8-jdk</span><br></pre></td></tr></table></figure>
</li>
<li><p>Add Bazel source list</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">echo &quot;deb [arch=amd64] http://storage.googleapis.com/bazel-apt stable jdk1.8&quot; | sudo tee /etc/apt/sources.list.d/bazel.list</span><br><span class="line"></span><br><span class="line">curl https://bazel.build/bazel-release.pub.gpg | sudo apt-key add -</span><br></pre></td></tr></table></figure>
</li>
<li><p>Install Bazel</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sudo apt update &amp;&amp; sudo apt install bazel</span><br><span class="line"></span><br><span class="line"># upgrade only</span><br><span class="line">sudo apt install --only-upgrade bazel</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h2 id="Install-bazel-by-binary"><a href="#Install-bazel-by-binary" class="headerlink" title="Install bazel by binary"></a>Install bazel by binary</h2><ul>
<li><p>Pre-install required packages</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install pkg-config zip g++ zlib1g-dev unzip python</span><br></pre></td></tr></table></figure>
</li>
<li><p>Download 0.19.2, due to tensorflow-upstream.git <a href="https://github.com/ROCmSoftwarePlatform/tensorflow-upstream/commit/d9ee32ca7db3a6cb0897d26d3cd9bd766e88fe8e#diff-d815c171a670ccb45b850c82a9b92d0c" target="_blank" rel="noopener">downgrading bazel version from 0.20.0 to 0.19.2 to workaround issue #24124</a></p>
<ul>
<li><a href="https://github.com/bazelbuild/bazel/releases" target="_blank" rel="noopener">bazel release page</a></li>
<li>bazel-0.19.2-installer-linux-x86_64.sh</li>
</ul>
</li>
<li><p>Install by script</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">chmod +x bazel-0.19.2-installer-linux-x86_64.sh</span><br><span class="line">./bazel-0.19.2-installer-linux-x86_64.sh --user</span><br></pre></td></tr></table></figure>

<ul>
<li><code>--user</code> install Bazel to <code>$HOME/bin</code> folder and export the path in <code>.bashrc</code></li>
</ul>
</li>
</ul>
<h1 id="Download-the-TensorFlow-source"><a href="#Download-the-TensorFlow-source" class="headerlink" title="Download the TensorFlow source"></a>Download the TensorFlow source</h1><ul>
<li><p>tensorflow</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/tensorflow/tensorflow.git</span><br></pre></td></tr></table></figure>
</li>
<li><p>tensorflow ROCm upstream</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/ROCmSoftwarePlatform/tensorflow-upstream.git</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h1 id="Build-TensorFlow-ROCm"><a href="#Build-TensorFlow-ROCm" class="headerlink" title="Build TensorFlow ROCm"></a>Build TensorFlow ROCm</h1><ul>
<li><p>Configuration</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">$ yes &quot;&quot; | TF_NEED_ROCM=1 PYTHON_BIN_PATH=/usr/bin/python3 ./configure</span><br><span class="line"></span><br><span class="line">WARNING: --batch mode is deprecated. Please instead explicitly shut down your Bazel server using the command &quot;bazel shutdown&quot;.                                                                              You have bazel 0.19.2 installed.</span><br><span class="line">Found possible Python library paths:</span><br><span class="line">  /usr/local/lib/python3.6/dist-packages</span><br><span class="line">  /usr/lib/python3/dist-packages</span><br><span class="line">Please input the desired Python library path to use.  Default is [/usr/local/lib/python3.6/dist-packages]</span><br><span class="line">Do you wish to build TensorFlow with XLA JIT support? [Y/n]: XLA JIT support will be enabled for TensorFlow.</span><br><span class="line"></span><br><span class="line">Do you wish to build TensorFlow with OpenCL SYCL support? [y/N]: No OpenCL SYCL support will be enabled for TensorFlow.</span><br><span class="line"></span><br><span class="line">Do you wish to build TensorFlow with CUDA support? [y/N]: No CUDA support will be enabled for TensorFlow.</span><br><span class="line"></span><br><span class="line">Do you wish to download a fresh release of clang? (Experimental) [y/N]: Clang will not be downloaded.</span><br><span class="line"></span><br><span class="line">Do you wish to build TensorFlow with MPI support? [y/N]: No MPI support will be enabled for TensorFlow.</span><br><span class="line"></span><br><span class="line">Please specify optimization flags to use during compilation when bazel option &quot;--config=opt&quot; is specified [Default is -march=native -Wno-sign-compare]:</span><br><span class="line"></span><br><span class="line">Would you like to interactively configure ./WORKSPACE for Android builds? [y/N]: Not configuring the WORKSPACE for Android builds.</span><br><span class="line"></span><br><span class="line">Preconfigured Bazel build configs. You can use any of the below by adding &quot;--config=&lt;&gt;&quot; to your build command. See .bazelrc for more details.</span><br><span class="line">        --config=mkl            # Build with MKL support.</span><br><span class="line">        --config=monolithic     # Config for mostly static monolithic build.</span><br><span class="line">        --config=gdr            # Build with GDR support.</span><br><span class="line">        --config=verbs          # Build with libverbs support.</span><br><span class="line">        --config=ngraph         # Build with Intel nGraph support.</span><br><span class="line">        --config=dynamic_kernels        # (Experimental) Build kernels into separate shared objects.</span><br><span class="line"></span><br><span class="line">Preconfigured Bazel build configs to DISABLE default on features:</span><br><span class="line">        --config=noaws          # Disable AWS S3 filesystem support.</span><br><span class="line">        --config=nogcp          # Disable GCP support.</span><br><span class="line">        --config=nohdfs         # Disable HDFS support.</span><br><span class="line">        --config=noignite       # Disable Apacha Ignite support.</span><br><span class="line">        --config=nokafka        # Disable Apache Kafka support.</span><br><span class="line">        --config=nonccl         # Disable NVIDIA NCCL support.</span><br><span class="line">Configuration finished</span><br></pre></td></tr></table></figure>
</li>
<li><p>Build tensorflow with ROCm</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bazel build --config=opt --config=rocm //tensorflow/tools/pip_package:build_pip_package</span><br></pre></td></tr></table></figure>

<ul>
<li>If the memory is constrained, build it as below: RAM (in MB), CPU (in cores) and available I/O (1.0 being average workstation)<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bazel build --local_resources 4096,4.0,1.0 -j 4 --config=opt --config=rocm //tensorflow/tools/pip_package:build_pip_package</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>Generate the tensorflow package</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">bazel-bin/tensorflow/tools/pip_package/build_pip_package /tmp/tensorflow_pkg</span><br><span class="line">2019年 01月 02日 星期三 12:10:26 CST : === Preparing sources in dir: /tmp/tmp.TfGUlmequ5</span><br><span class="line">~/repo/tensorflow-upstream ~/repo/tensorflow-upstream</span><br><span class="line">~/repo/tensorflow-upstream</span><br><span class="line">2019年 01月 02日 星期三 12:10:43 CST : === Building wheel</span><br><span class="line">warning: no files found matching &apos;*.pyd&apos; under directory &apos;*&apos;</span><br><span class="line">warning: no files found matching &apos;*.pd&apos; under directory &apos;*&apos;</span><br><span class="line">warning: no files found matching &apos;*.dll&apos; under directory &apos;*&apos;</span><br><span class="line">warning: no files found matching &apos;*.lib&apos; under directory &apos;*&apos;</span><br><span class="line">warning: no files found matching &apos;*.h&apos; under directory &apos;tensorflow/include/tensorflow&apos;</span><br><span class="line">warning: no files found matching &apos;*&apos; under directory &apos;tensorflow/include/Eigen&apos;</span><br><span class="line">warning: no files found matching &apos;*.h&apos; under directory &apos;tensorflow/include/google&apos;</span><br><span class="line">warning: no files found matching &apos;*&apos; under directory &apos;tensorflow/include/third_party&apos;</span><br><span class="line">warning: no files found matching &apos;*&apos; under directory &apos;tensorflow/include/unsupported&apos;</span><br><span class="line">2019年 01月 02日 星期三 12:11:02 CST : === Output wheel file is in: /tmp/tensorflow_pkg</span><br></pre></td></tr></table></figure>
</li>
<li><p>Install the wheel package with ROCm</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">pip3 install  /tmp/tensorflow_pkg/tensorflow-1.12.0-cp36-cp36m-linux_x86_64.whl</span><br><span class="line"></span><br><span class="line">Processing /tmp/tensorflow_pkg/tensorflow-1.12.0-cp36-cp36m-linux_x86_64.whl</span><br><span class="line">Collecting tensorboard&lt;1.13.0,&gt;=1.12.0 (from tensorflow==1.12.0)</span><br><span class="line">  Using cached https://files.pythonhosted.org/packages/bd/7e/528c868bb8a0542c8a5686ff3a08502d2691bd50499c6e55f8989fa8e5a0/tensorboard-1.12.1-py3-none-any.whl</span><br><span class="line">Collecting grpcio&gt;=1.8.6 (from tensorflow==1.12.0)</span><br><span class="line">  Using cached https://files.pythonhosted.org/packages/3b/bb/701d879849c938028c09fdb5405dbde7c86644bbbb90098094002db23ded/grpcio-1.17.1-cp36-cp36m-manylinux1_x86_64.whl</span><br><span class="line">Collecting numpy&gt;=1.13.3 (from tensorflow==1.12.0)</span><br><span class="line">  Using cached https://files.pythonhosted.org/packages/ff/7f/9d804d2348471c67a7d8b5f84f9bc59fd1cefa148986f2b74552f8573555/numpy-1.15.4-cp36-cp36m-manylinux1_x86_64.whl</span><br><span class="line">Collecting tensorflow-estimator&gt;=1.10.0 (from tensorflow==1.12.0)</span><br><span class="line">  Using cached https://files.pythonhosted.org/packages/e7/5a/bace04b34b4a3214ed105899a27f3e94f0468b64bce46125ff42f495b1fc/tensorflow_estimator-1.10.12-py2.py3-none-any.whl</span><br><span class="line">Collecting six&gt;=1.10.0 (from tensorflow==1.12.0)</span><br><span class="line">  Using cached https://files.pythonhosted.org/packages/73/fb/00a976f728d0d1fecfe898238ce23f502a721c0ac0ecfedb80e0d88c64e9/six-1.12.0-py2.py3-none-any.whl</span><br><span class="line">Collecting gast&gt;=0.2.0 (from tensorflow==1.12.0)</span><br><span class="line">Collecting wheel&gt;=0.26 (from tensorflow==1.12.0)</span><br><span class="line">  Using cached https://files.pythonhosted.org/packages/ff/47/1dfa4795e24fd6f93d5d58602dd716c3f101cfd5a77cd9acbe519b44a0a9/wheel-0.32.3-py2.py3-none-any.whl</span><br><span class="line">Collecting protobuf&gt;=3.6.1 (from tensorflow==1.12.0)</span><br><span class="line">  Using cached https://files.pythonhosted.org/packages/c2/f9/28787754923612ca9bfdffc588daa05580ed70698add063a5629d1a4209d/protobuf-3.6.1-cp36-cp36m-manylinux1_x86_64.whl</span><br><span class="line">Collecting absl-py&gt;=0.1.6 (from tensorflow==1.12.0)</span><br><span class="line">Collecting keras-applications&gt;=1.0.6 (from tensorflow==1.12.0)</span><br><span class="line">  Using cached https://files.pythonhosted.org/packages/3f/c4/2ff40221029f7098d58f8d7fb99b97e8100f3293f9856f0fb5834bef100b/Keras_Applications-1.0.6-py2.py3-none-any.whl</span><br><span class="line">Collecting astor&gt;=0.6.0 (from tensorflow==1.12.0)</span><br><span class="line">  Using cached https://files.pythonhosted.org/packages/35/6b/11530768cac581a12952a2aad00e1526b89d242d0b9f59534ef6e6a1752f/astor-0.7.1-py2.py3-none-any.whl</span><br><span class="line">Collecting keras-preprocessing&gt;=1.0.5 (from tensorflow==1.12.0)</span><br><span class="line">  Using cached https://files.pythonhosted.org/packages/fc/94/74e0fa783d3fc07e41715973435dd051ca89c550881b3454233c39c73e69/Keras_Preprocessing-1.0.5-py2.py3-none-any.whl</span><br><span class="line">Collecting termcolor&gt;=1.1.0 (from tensorflow==1.12.0)</span><br><span class="line">Collecting werkzeug&gt;=0.11.10 (from tensorboard&lt;1.13.0,&gt;=1.12.0-&gt;tensorflow==1.12.0)</span><br><span class="line">  Using cached https://files.pythonhosted.org/packages/20/c4/12e3e56473e52375aa29c4764e70d1b8f3efa6682bef8d0aae04fe335243/Werkzeug-0.14.1-py2.py3-none-any.whl</span><br><span class="line">Collecting markdown&gt;=2.6.8 (from tensorboard&lt;1.13.0,&gt;=1.12.0-&gt;tensorflow==1.12.0)</span><br><span class="line">  Using cached https://files.pythonhosted.org/packages/7a/6b/5600647404ba15545ec37d2f7f58844d690baf2f81f3a60b862e48f29287/Markdown-3.0.1-py2.py3-none-any.whl</span><br><span class="line">Collecting mock&gt;=2.0.0 (from tensorflow-estimator&gt;=1.10.0-&gt;tensorflow==1.12.0)</span><br><span class="line">  Using cached https://files.pythonhosted.org/packages/e6/35/f187bdf23be87092bd0f1200d43d23076cee4d0dec109f195173fd3ebc79/mock-2.0.0-py2.py3-none-any.whl</span><br><span class="line">Collecting setuptools (from protobuf&gt;=3.6.1-&gt;tensorflow==1.12.0)</span><br><span class="line">  Using cached https://files.pythonhosted.org/packages/37/06/754589caf971b0d2d48f151c2586f62902d93dc908e2fd9b9b9f6aa3c9dd/setuptools-40.6.3-py2.py3-none-any.whl</span><br><span class="line">Collecting h5py (from keras-applications&gt;=1.0.6-&gt;tensorflow==1.12.0)</span><br><span class="line">  Using cached https://files.pythonhosted.org/packages/30/99/d7d4fbf2d02bb30fb76179911a250074b55b852d34e98dd452a9f394ac06/h5py-2.9.0-cp36-cp36m-manylinux1_x86_64.whl</span><br><span class="line">Collecting pbr&gt;=0.11 (from mock&gt;=2.0.0-&gt;tensorflow-estimator&gt;=1.10.0-&gt;tensorflow==1.12.0)</span><br><span class="line">  Using cached https://files.pythonhosted.org/packages/f3/04/fddc1c2dd75b256eda4d360024692231a2c19a0c61ad7f4a162407c1ab58/pbr-5.1.1-py2.py3-none-any.whl</span><br><span class="line">Installing collected packages: werkzeug, six, grpcio, setuptools, protobuf, wheel, numpy, markdown, tensorboard, pbr, mock, absl-py, tensorflow-estimator, gast, h5py, keras-applications, astor, keras-preprocessing, termcolor, tensorflow</span><br><span class="line">Successfully installed absl-py-0.6.1 astor-0.7.1 gast-0.2.0 grpcio-1.17.1 h5py-2.9.0 keras-applications-1.0.6 keras-preprocessing-1.0.5 markdown-3.0.1 mock-2.0.0 numpy-1.15.4 pbr-5.1.1 protobuf-3.6.1 setuptools-40.6.3 six-1.12.0 tensorboard-1.12.1 tensorflow-1.12.0 tensorflow-estimator-1.10.12 termcolor-1.1.0 werkzeug-0.14.1 wheel-0.32.3</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h1 id="Verify-TensorFlow-by-hello-exmaple"><a href="#Verify-TensorFlow-by-hello-exmaple" class="headerlink" title="Verify TensorFlow by hello exmaple"></a>Verify TensorFlow by hello exmaple</h1><ul>
<li><p>tensorflow-upstream(develop-upstream)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"># go out of buidling folder</span><br><span class="line">$ cd ~</span><br><span class="line">$ python3</span><br><span class="line">Python 3.6.7 (default, Oct 22 2018, 11:32:17)</span><br><span class="line">[GCC 8.2.0] on linux</span><br><span class="line">Type &quot;help&quot;, &quot;copyright&quot;, &quot;credits&quot; or &quot;license&quot; for more information.</span><br><span class="line">&gt;&gt;&gt; import tensorflow as tf</span><br><span class="line">2019-01-02 14:21:18.320305: E tensorflow/stream_executor/rocm/rocm_blas.cc:2335] Unable to register rocBLAS factory: Attempting to register factory for plugin rocBLAS when one has already been registered</span><br><span class="line">2019-01-02 14:21:18.320333: E tensorflow/stream_executor/rocm/rocm_dnn.cc:5125] Unable to register MIOpen factory: Attempting to register factory for plugin MIOpen when one has already been registered</span><br><span class="line">&gt;&gt;&gt; hello = tf.constant(&apos;Hello, TensorFlow&apos;)</span><br><span class="line">&gt;&gt;&gt; sess = tf.Session()</span><br><span class="line">2019-01-02 14:21:29.515332: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1532] Found device 0 with properties:</span><br><span class="line">name: Vega [Radeon RX Vega]</span><br><span class="line">AMDGPU ISA: gfx900</span><br><span class="line">memoryClockRate (GHz) 1.59</span><br><span class="line">pciBusID 0000:03:00.0</span><br><span class="line">Total memory: 7.98GiB</span><br><span class="line">Free memory: 7.73GiB</span><br><span class="line">2019-01-02 14:21:29.515387: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1643] Adding visible gpu devices: 0</span><br><span class="line">2019-01-02 14:21:29.515418: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1054] Device interconnect StreamExecutor with strength 1 edge matrix:</span><br><span class="line">2019-01-02 14:21:29.515426: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1060]      0</span><br><span class="line">2019-01-02 14:21:29.515433: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1073] 0:   N</span><br><span class="line">2019-01-02 14:21:29.515488: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1190] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 7524 MB memory) -&gt; physical GPU (device: 0, name: Vega [Radeon RX Vega], pci bus id: 0000:03:00.0)</span><br><span class="line">&gt;&gt;&gt; sess.run(hello)</span><br><span class="line">b&apos;Hello, TensorFlow&apos;</span><br></pre></td></tr></table></figure>
</li>
<li><p>tensorflow(master), enabling CPU only(not sure the reason)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">python3</span><br><span class="line">Python 3.6.7 (default, Oct 22 2018, 11:32:17)</span><br><span class="line">[GCC 8.2.0] on linux</span><br><span class="line">Type &quot;help&quot;, &quot;copyright&quot;, &quot;credits&quot; or &quot;license&quot; for more information.</span><br><span class="line">&gt;&gt;&gt; import tensorflow as tf</span><br><span class="line">&gt;&gt;&gt; hello = tf.constant(&apos;Hello, TensorFlow&apos;)</span><br><span class="line">&gt;&gt;&gt; sess.run(hello)</span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  File &quot;&lt;stdin&gt;&quot;, line 1, in &lt;module&gt;</span><br><span class="line">NameError: name &apos;sess&apos; is not defined</span><br><span class="line">&gt;&gt;&gt; sess = tf.Session()</span><br><span class="line">2019-01-02 14:36:01.000696: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3408000000 Hz</span><br><span class="line">2019-01-02 14:36:01.001841: I tensorflow/compiler/xla/service/service.cc:161] XLA service 0x7f39586d2330 executing computations on platform Host. Devices:</span><br><span class="line">2019-01-02 14:36:01.001915: I tensorflow/compiler/xla/service/service.cc:168]   StreamExecutor device (0): &lt;undefined&gt;, &lt;undefined&gt;</span><br><span class="line">&gt;&gt;&gt; sess.run(hello)</span><br><span class="line">b&apos;Hello, TensorFlow&apos;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ul>
<li><a href="https://docs.bazel.build/versions/master/install-ubuntu.html" target="_blank" rel="noopener">Installing Bazel on Ubuntu</a></li>
<li><a href="https://github.com/ROCmSoftwarePlatform/tensorflow-upstream/blob/develop-upstream/rocm_docs/tensorflow-build-from-source.md" target="_blank" rel="noopener">TensorFlow ROCm build readme</a></li>
</ul>
  
	</div>
		<footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/Compute/">Compute</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/ROCm/">ROCm</a><a href="/tags/TensorFlow/">TensorFlow</a>
  </div>

</div>



	<div class="article-share" id="share">
	
	  <div data-url="http://zjunweihit.github.io/2019/01/02/compute-env-tensorflow-build-from-source/" data-title="TensorFlow Build From Source | Linux Player" data-tsina="3230658564" class="share clearfix">
	  </div>
	
	</div>


</footer>

   	       
	</article>
	
<nav class="article-nav clearfix">
 
 <div class="prev" >
 <a href="/2019/01/03/compute-rocm-docker-setup/" title="ROCm Docker Setup">
  <strong>上一篇：</strong><br/>
  <span>
  ROCm Docker Setup</span>
</a>
</div>


<div class="next">
<a href="/2018/12/25/compute-rocm-neural-style/"  title="TensorFlow Example&gt; Neural Style">
 <strong>下一篇：</strong><br/> 
 <span>TensorFlow Example&gt; Neural Style
</span>
</a>
</div>

</nav>

	

</div>  
      <div class="openaside"><a class="navbutton" href="#" title="Show Sidebar"></a></div>

  <div id="toc" class="toc-aside">
  <strong class="toc-title">Contents</strong>
 
 <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Software-in-Ubuntu-18-04"><span class="toc-number">1.</span> <span class="toc-text">Software in Ubuntu 18.04</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Install-Bazel"><span class="toc-number">2.</span> <span class="toc-text">Install Bazel</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Install-bazel-online"><span class="toc-number">2.1.</span> <span class="toc-text">Install bazel online</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Install-bazel-by-binary"><span class="toc-number">2.2.</span> <span class="toc-text">Install bazel by binary</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Download-the-TensorFlow-source"><span class="toc-number">3.</span> <span class="toc-text">Download the TensorFlow source</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Build-TensorFlow-ROCm"><span class="toc-number">4.</span> <span class="toc-text">Build TensorFlow ROCm</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Verify-TensorFlow-by-hello-exmaple"><span class="toc-number">5.</span> <span class="toc-text">Verify TensorFlow by hello exmaple</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Reference"><span class="toc-number">6.</span> <span class="toc-text">Reference</span></a></li></ol>
 
  </div>

<div id="asidepart">
<div class="closeaside"><a class="closebutton" href="#" title="Hide Sidebar"></a></div>
<aside class="clearfix">

  
<div class="github-card">
<p class="asidetitle">Github Card</p>
<div class="github-card" data-github="zjunweihit" data-width="220" data-height="119" data-theme="medium">
<script type="text/javascript" src="//cdn.jsdelivr.net/github-cards/latest/widget.js" ></script>
</div>
  </div>



  
<div class="categorieslist">
	<p class="asidetitle">Categories</p>
		<ul>
		
		  
			<li><a href="/categories/Compute/" title="Compute">Compute<sup>15</sup></a></li>
		  
		
		  
			<li><a href="/categories/linux-dev/Graphics/" title="Graphics">Graphics<sup>4</sup></a></li>
		  
		
		  
			<li><a href="/categories/linux-dev/" title="linux-dev">linux-dev<sup>5</sup></a></li>
		  
		
		  
			<li><a href="/categories/linux-env/" title="linux-env">linux-env<sup>11</sup></a></li>
		  
		
		</ul>
</div>


  
<div class="tagslist">
	<p class="asidetitle">Tags</p>
		<ul class="clearfix">
		
			
				<li><a href="/tags/Wiki/" title="Wiki">Wiki<sup>5</sup></a></li>
			
		
			
				<li><a href="/tags/ROCm/" title="ROCm">ROCm<sup>5</sup></a></li>
			
		
			
				<li><a href="/tags/linux-env-misc/" title="linux-env-misc">linux-env-misc<sup>4</sup></a></li>
			
		
			
				<li><a href="/tags/ubuntu/" title="ubuntu">ubuntu<sup>4</sup></a></li>
			
		
			
				<li><a href="/tags/Xorg/" title="Xorg">Xorg<sup>3</sup></a></li>
			
		
			
				<li><a href="/tags/TensorFlow/" title="TensorFlow">TensorFlow<sup>3</sup></a></li>
			
		
			
				<li><a href="/tags/SCM/" title="SCM">SCM<sup>3</sup></a></li>
			
		
			
				<li><a href="/tags/OpenCL/" title="OpenCL">OpenCL<sup>3</sup></a></li>
			
		
			
				<li><a href="/tags/linux-dev-misc/" title="linux-dev-misc">linux-dev-misc<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/cmake/" title="cmake">cmake<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/Framework/" title="Framework">Framework<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/BLAS/" title="BLAS">BLAS<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/linux-env/" title="linux-env">linux-env<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/Graphics/" title="Graphics">Graphics<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/Compute/" title="Compute">Compute<sup>1</sup></a></li>
			
		
		</ul>
</div>


  <div class="linkslist">
  <p class="asidetitle">Links</p>
    <ul>
        
          <li>
            
            	<a href="https://en.wikipedia.org" target="_blank" title="wikipedia(en)">wikipedia(en)</a>
            
          </li>
        
    </ul>
</div>

</aside>
</div>
    </div>
    <footer><div id="footer" >
	
	<div class="line">
		<span></span>
		<div class="author"></div>
	</div>
	
	
	<section class="info">
		<p> Running on the Linux road <br/>
			Try everything</p>
	</section>
	 
	<div class="social-font" class="clearfix">
		
		<a href="http://weibo.com/3230658564" target="_blank" class="icon-weibo" title="微博"></a>
		
		
		<a href="https://github.com/zjunweihit" target="_blank" class="icon-github" title="github"></a>
		
		
		
		
		
		
		
		
		
		<a href="mailto:zjunweihit@163.com" target="_blank" class="icon-email" title="Email Me"></a>
		
	</div>
			
		

		<p class="copyright">
		Powered by <a href="http://hexo.io" target="_blank" title="hexo">hexo</a> and Theme by <a href="https://github.com/wuchong/jacman" target="_blank" title="Jacman">Jacman</a> © 2019 
		
		<a href="/about" target="_blank" title="zjunweihit">zjunweihit</a>
		
		
		</p>
</div>
</footer>
    <script src="/js/jquery-2.0.3.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/jquery.qrcode-0.12.0.min.js"></script>

<script type="text/javascript">
$(document).ready(function(){ 
  $('.navbar').click(function(){
    $('header nav').toggleClass('shownav');
  });
  var myWidth = 0;
  function getSize(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
  };
  var m = $('#main'),
      a = $('#asidepart'),
      c = $('.closeaside'),
      o = $('.openaside');
  c.click(function(){
    a.addClass('fadeOut').css('display', 'none');
    o.css('display', 'block').addClass('fadeIn');
    m.addClass('moveMain');
  });
  o.click(function(){
    o.css('display', 'none').removeClass('beforeFadeIn');
    a.css('display', 'block').removeClass('fadeOut').addClass('fadeIn');      
    m.removeClass('moveMain');
  });
  $(window).scroll(function(){
    o.css("top",Math.max(80,260-$(this).scrollTop()));
  });
  
  $(window).resize(function(){
    getSize(); 
    if (myWidth >= 1024) {
      $('header nav').removeClass('shownav');
    }else{
      m.removeClass('moveMain');
      a.css('display', 'block').removeClass('fadeOut');
      o.css('display', 'none');
      
      $('#toc.toc-aside').css('display', 'none');
        
    }
  });
});
</script>

<script type="text/javascript">
$(document).ready(function(){ 
  var ai = $('.article-content>iframe'),
      ae = $('.article-content>embed'),
      t  = $('#toc'),
      ta = $('#toc.toc-aside'),
      o  = $('.openaside'),
      c  = $('.closeaside');
  if(ai.length>0){
    ai.wrap('<div class="video-container" />');
  };
  if(ae.length>0){
   ae.wrap('<div class="video-container" />');
  };
  c.click(function(){
    ta.css('display', 'block').addClass('fadeIn');
  });
  o.click(function(){
    ta.css('display', 'none');
  });
  $(window).scroll(function(){
    ta.css("top",Math.max(140,320-$(this).scrollTop()));
  });
});
</script>


<script type="text/javascript">
$(document).ready(function(){ 
  var $this = $('.share'),
      url = $this.attr('data-url'),
      encodedUrl = encodeURIComponent(url),
      title = $this.attr('data-title'),
      tsina = $this.attr('data-tsina'),
      description = $this.attr('description');
  var html = [
  '<div class="hoverqrcode clearfix"></div>',
  '<a class="overlay" id="qrcode"></a>',
  '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="article-share-facebook" target="_blank" title="Facebook"></a>',
  '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="article-share-twitter" target="_blank" title="Twitter"></a>',
  '<a href="#qrcode" class="article-share-qrcode" title="微信"></a>',
  '<a href="http://widget.renren.com/dialog/share?resourceUrl=' + encodedUrl + '&srcUrl=' + encodedUrl + '&title=' + title +'" class="article-share-renren" target="_blank" title="人人"></a>',
  '<a href="http://service.weibo.com/share/share.php?title='+title+'&url='+encodedUrl +'&ralateUid='+ tsina +'&searchPic=true&style=number' +'" class="article-share-weibo" target="_blank" title="微博"></a>',
  '<span title="Share to"></span>'
  ].join('');
  $this.append(html);

  $('.hoverqrcode').hide();

  var myWidth = 0;
  function updatehoverqrcode(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
    var qrsize = myWidth > 1024 ? 200:100;
    var options = {render: 'image', size: qrsize, fill: '#2ca6cb', text: url, radius: 0.5, quiet: 1};
    var p = $('.article-share-qrcode').position();
    $('.hoverqrcode').empty().css('width', qrsize).css('height', qrsize)
                          .css('left', p.left-qrsize/2+20).css('top', p.top-qrsize-10)
                          .qrcode(options);
  };
  $(window).resize(function(){
    $('.hoverqrcode').hide();
  });
  $('.article-share-qrcode').click(function(){
    updatehoverqrcode();
    $('.hoverqrcode').toggle();
  });
  $('.article-share-qrcode').hover(function(){}, function(){
      $('.hoverqrcode').hide();
  });
});   
</script>









<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
$(document).ready(function(){ 
  $('.article-content').each(function(i){
    $(this).find('img').each(function(){
      if ($(this).parent().hasClass('fancybox')) return;
      var alt = this.alt;
      if (alt) $(this).after('<span class="caption">' + alt + '</span>');
      $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox"></a>');
    });
    $(this).find('.fancybox').each(function(){
      $(this).attr('rel', 'article' + i);
    });
  });
  if($.fancybox){
    $('.fancybox').fancybox();
  }
}); 
</script>



<!-- Analytics Begin -->



<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?e6d1f421bbc9962127a50488f9ed37d1";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>



<!-- Analytics End -->

<!-- Totop Begin -->

	<div id="totop">
	<a title="Back to Top"><img src="/img/scrollup.png"/></a>
	</div>
	<script src="/js/totop.js"></script>

<!-- Totop End -->

<!-- MathJax Begin -->
<!-- mathjax config similar to math.stackexchange -->


<!-- MathJax End -->

<!-- Tiny_search Begin -->

<!-- Tiny_search End -->

  </body>
</html>
